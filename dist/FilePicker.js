!function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(1))},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(2);n(3);var r=function(e){function t(t){var n=e.call(this,t)||this;n.componentId="",n.flowKey="",n.attributes={},n.selectedItem=null,n.text="",n.componentId=t.id,n.flowKey=t.flowKey;var o=manywho.model.getComponent(n.props.id,n.props.flowKey);if(o.attributes)for(var i in o.attributes)n.attributes[i]=o.attributes[i];return n}return o(t,e),t.prototype.componentDidMount=function(){this.forceUpdate()},t.prototype.componentDidUpdate=function(){},t.prototype.getAttribute=function(e){return this.attributes[e]?this.attributes[e]:null},t.prototype.render=function(){var e,t=manywho.model.getComponent(this.componentId,this.flowKey),n=manywho.state.getComponent(this.componentId,this.flowKey),o=this.getAttribute("Title")||"Select File",r=t.width+"px",a=t.height+"px",l={};if(l.width=r,l.height=a,t.isEditable){e=this.pickFile.bind(this);var s=i.createElement("span",{className:"glyphicon glyphicon-remove file-box-header-button",onClick:this.clearFile.bind(this)})}return i.createElement("div",{className:"file-box",style:l},i.createElement("div",{className:"file-box-header"},i.createElement("div",{className:"file-box-header-left"},i.createElement("span",{className:"file-box-header-title"},o)),i.createElement("div",{className:"file-box-header-right"},s)),i.createElement("div",{className:"file-box-body",onClick:e},i.createElement("img",{ref:"img",className:"file-image",src:n.contentValue}),i.createElement("input",{ref:"file",type:"file",className:"file-file",onChange:this.fileSelected.bind(this)})))},t.prototype.clearFile=function(){this.refs.file},t.prototype.pickFile=function(){var e;e=this.refs.file,e.click()},t.prototype.fileSelected=function(){var e;if(e=this.refs.file,e.files&&e.files.length>0){var t=(manywho.model.getComponent(this.componentId,this.flowKey),manywho.state.getComponent(this.componentId,this.flowKey),this),n=new FileReader;n.onload=function(e){t.ResizeBase64Img(e.target.result,400)},n.readAsDataURL(e.files[0])}},t.prototype.ResizeBase64Img=function(e,t){var n=manywho.state.getComponent(this.componentId,this.flowKey),o=(manywho.model.getComponent(this.componentId,this.flowKey),new Image),i=this;o.onload=function(){var e=o.height/o.width,r=document.createElement("canvas");o.width;r.width=t,r.height=t*e;var a=r.getContext("2d");o.width;a.scale(r.width/o.width,r.height/o.height),a.drawImage(o,0,0);var l=r.toDataURL();n.contentValue=l,o.src=l,i.forceUpdate()},o.src=e},t}(i.Component);manywho.component.register("FilePicker",r),t.default=r},function(e,t){e.exports=React},function(e,t){}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vRmlsZVBpY2tlci5qcyIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgMDFiMjM3Mjc5NjBhYWRmY2Y0ZjciLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LnRzeCIsIndlYnBhY2s6Ly8vLi9zcmMvRmlsZVBpY2tlci50c3giLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiUmVhY3RcIiJdLCJuYW1lcyI6WyJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsImdldCIsIm4iLCJfX2VzTW9kdWxlIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwidmFsdWUiLCJfX2V4dGVuZHMiLCJ0aGlzIiwiZXh0ZW5kU3RhdGljcyIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiQXJyYXkiLCJiIiwiX18iLCJjb25zdHJ1Y3RvciIsImNyZWF0ZSIsIlJlYWN0IiwiRmlsZVBpY2tlciIsIl9zdXBlciIsInByb3BzIiwiX3RoaXMiLCJjb21wb25lbnRJZCIsImZsb3dLZXkiLCJhdHRyaWJ1dGVzIiwic2VsZWN0ZWRJdGVtIiwidGV4dCIsImlkIiwiZmxvd01vZGVsIiwibWFueXdobyIsIm1vZGVsIiwiZ2V0Q29tcG9uZW50Iiwia2V5IiwiY29tcG9uZW50RGlkTW91bnQiLCJmb3JjZVVwZGF0ZSIsImNvbXBvbmVudERpZFVwZGF0ZSIsImdldEF0dHJpYnV0ZSIsImF0dHJpYnV0ZU5hbWUiLCJyZW5kZXIiLCJmaWxlUGljayIsImZsb3dTdGF0ZSIsInN0YXRlIiwiY2FwdGlvbiIsIndpZHRoIiwiaGVpZ2h0Iiwic3R5bGUiLCJpc0VkaXRhYmxlIiwicGlja0ZpbGUiLCJiaW5kIiwiY2xlYXJCdXR0b24iLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwib25DbGljayIsImNsZWFyRmlsZSIsInJlZiIsInNyYyIsImNvbnRlbnRWYWx1ZSIsInR5cGUiLCJvbkNoYW5nZSIsImZpbGVTZWxlY3RlZCIsInJlZnMiLCJmaWxlIiwiY2xpY2siLCJmaWxlcyIsImxlbmd0aCIsImFhXzEiLCJyZWFkZXIiLCJGaWxlUmVhZGVyIiwib25sb2FkIiwiZSIsIlJlc2l6ZUJhc2U2NEltZyIsInRhcmdldCIsInJlc3VsdCIsInJlYWRBc0RhdGFVUkwiLCJiYXNlNjQiLCJpbWciLCJJbWFnZSIsImFzcGVjdFJhdGlvIiwiY2FudmFzIiwiZG9jdW1lbnQiLCJjb250ZXh0IiwiZ2V0Q29udGV4dCIsInNjYWxlIiwiZHJhd0ltYWdlIiwicmVzaXplZCIsInRvRGF0YVVSTCIsIkNvbXBvbmVudCIsImNvbXBvbmVudCIsInJlZ2lzdGVyIiwiZGVmYXVsdCJdLCJtYXBwaW5ncyI6IkNBQVMsU0FBVUEsR0NJbkIsUUFBQUMsR0FBQUMsR0FHQSxHQUFBQyxFQUFBRCxHQUNBLE1BQUFDLEdBQUFELEdBQUFFLE9BR0EsSUFBQUMsR0FBQUYsRUFBQUQsSUFDQUksRUFBQUosRUFDQUssR0FBQSxFQUNBSCxXQVVBLE9BTkFKLEdBQUFFLEdBQUFNLEtBQUFILEVBQUFELFFBQUFDLElBQUFELFFBQUFILEdBR0FJLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUF2QkEsR0FBQUQsS0E0QkFGLEdBQUFRLEVBQUFULEVBR0FDLEVBQUFTLEVBQUFQLEVBR0FGLEVBQUFVLEVBQUEsU0FBQVAsRUFBQVEsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVYsRUFBQVEsSUFDQUcsT0FBQUMsZUFBQVosRUFBQVEsR0FDQUssY0FBQSxFQUNBQyxZQUFBLEVBQ0FDLElBQUFOLEtBTUFaLEVBQUFtQixFQUFBLFNBQUFmLEdBQ0EsR0FBQVEsR0FBQVIsS0FBQWdCLFdBQ0EsV0FBMkIs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RGM5QyxRQUFRQyxNQUFNQyxhQUFhdkIsS0FBS2MsWUFBZWQsS0FBS2UsU0FDNUQsR0FBSXFELFFBQ1ZuQyxFQUFhakMsSUFDakJtRSxHQUFJUCxPQUFTLFdBR1QsR0FBSVMsR0FBY0YsRUFBSS9CLE9BQVErQixFQUFJaEMsTUFDOUJtQyxFQUFTQyxTQUFTN0IsY0FBYyxTQUVOeUIsR0FBSWhDLEtBRWxDbUMsR0FBT25DLE1BQVFBLEVBQ2ZtQyxFQUFPbEMsT0FBU0QsRUFBUWtDLENBRXhCLElBQUlHLEdBQVVGLEVBQU9HLFdBQVcsS0FFRk4sR0FBSWhDLEtBQ2xDcUMsR0FBUUUsTUFBTUosRUFBT25DLE1BQU1nQyxFQUFJaEMsTUFBUW1DLEVBQU9sQyxPQUFTK0IsRUFBSS9CLFFBRTNEb0MsRUFBUUcsVUFBVVIsRUFBSyxFQUFJLEVBQzNCLElBQUlTLEdBQVVOLEVBQU9PLFdBRXJCN0MsR0FBVWdCLGFBQWU0QixFQUN6QlQsRUFBSXBCLElBQU02QixFQUNWM0MsRUFBTVAsZUFFVnlDLEVBQUlwQixJQUFNbUIsR0FFbEJ4RCxHQTNKeUJELEVBQU1xRSxVQTZKL0J6RCxTQUFRMEQsVUFBVUMsU0FBUyxhQUFjdEUsR0FFekNwQyxFQUFBMkcsUUFBZXZFLEdIeUNULFNBQVVuQyxFQUFRRCxHSTlNeEJDLEVBQUFELFFBQUFtQyxPSm9OTSxTQUFVbEMsRUFBUUQiLCJmaWxlIjoiRmlsZVBpY2tlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0aTogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9XG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4vKioqKioqLyBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuLyoqKioqKi8gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbi8qKioqKiovIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbi8qKioqKiovIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbi8qKioqKiovIFx0XHRcdH0pO1xuLyoqKioqKi8gXHRcdH1cbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuLyoqKioqKi8gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4vKioqKioqLyBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuLyoqKioqKi8gXHRcdHJldHVybiBnZXR0ZXI7XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cclxuZnVuY3Rpb24gX19leHBvcnQobSkge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xyXG59XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuX19leHBvcnQoX193ZWJwYWNrX3JlcXVpcmVfXygxKSk7XHJcblxuXG4vKioqLyB9KSxcbi8qIDEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cclxudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuICAgIH07XHJcbn0pKCk7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxudmFyIFJlYWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcclxuX193ZWJwYWNrX3JlcXVpcmVfXygzKTtcclxudmFyIEZpbGVQaWNrZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoRmlsZVBpY2tlciwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEZpbGVQaWNrZXIocHJvcHMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5jb21wb25lbnRJZCA9IFwiXCI7XHJcbiAgICAgICAgX3RoaXMuZmxvd0tleSA9IFwiXCI7XHJcbiAgICAgICAgX3RoaXMuYXR0cmlidXRlcyA9IHt9O1xyXG4gICAgICAgIF90aGlzLnNlbGVjdGVkSXRlbSA9IG51bGw7XHJcbiAgICAgICAgX3RoaXMudGV4dCA9IFwiXCI7XHJcbiAgICAgICAgX3RoaXMuY29tcG9uZW50SWQgPSBwcm9wcy5pZDtcclxuICAgICAgICBfdGhpcy5mbG93S2V5ID0gcHJvcHMuZmxvd0tleTtcclxuICAgICAgICAvL3B1c2ggYXR0cmlidXRlcyBpbnRvIGtleWVkIG1hcCBcclxuICAgICAgICB2YXIgZmxvd01vZGVsID0gbWFueXdoby5tb2RlbC5nZXRDb21wb25lbnQoX3RoaXMucHJvcHMuaWQsIF90aGlzLnByb3BzLmZsb3dLZXkpO1xyXG4gICAgICAgIGlmIChmbG93TW9kZWwuYXR0cmlidXRlcykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gZmxvd01vZGVsLmF0dHJpYnV0ZXMpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmF0dHJpYnV0ZXNba2V5XSA9IGZsb3dNb2RlbC5hdHRyaWJ1dGVzW2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgRmlsZVBpY2tlci5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5mb3JjZVVwZGF0ZSgpO1xyXG4gICAgfTtcclxuICAgIEZpbGVQaWNrZXIucHJvdG90eXBlLmNvbXBvbmVudERpZFVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIH07XHJcbiAgICBGaWxlUGlja2VyLnByb3RvdHlwZS5nZXRBdHRyaWJ1dGUgPSBmdW5jdGlvbiAoYXR0cmlidXRlTmFtZSkge1xyXG4gICAgICAgIGlmICh0aGlzLmF0dHJpYnV0ZXNbYXR0cmlidXRlTmFtZV0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXR0cmlidXRlc1thdHRyaWJ1dGVOYW1lXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBGaWxlUGlja2VyLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGZsb3dNb2RlbCA9IG1hbnl3aG8ubW9kZWwuZ2V0Q29tcG9uZW50KHRoaXMuY29tcG9uZW50SWQsIHRoaXMuZmxvd0tleSk7XHJcbiAgICAgICAgdmFyIGZsb3dTdGF0ZSA9IG1hbnl3aG8uc3RhdGUuZ2V0Q29tcG9uZW50KHRoaXMuY29tcG9uZW50SWQsIHRoaXMuZmxvd0tleSk7XHJcbiAgICAgICAgdmFyIGZpbGVQaWNrO1xyXG4gICAgICAgIHZhciBjYXB0aW9uID0gdGhpcy5nZXRBdHRyaWJ1dGUoXCJUaXRsZVwiKSB8fCBcIlNlbGVjdCBGaWxlXCI7XHJcbiAgICAgICAgdmFyIHdpZHRoID0gZmxvd01vZGVsLndpZHRoICsgXCJweFwiO1xyXG4gICAgICAgIHZhciBoZWlnaHQgPSBmbG93TW9kZWwuaGVpZ2h0ICsgXCJweFwiO1xyXG4gICAgICAgIHZhciBzdHlsZSA9IHt9O1xyXG4gICAgICAgIHN0eWxlLndpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0O1xyXG4gICAgICAgIGlmIChmbG93TW9kZWwuaXNFZGl0YWJsZSkge1xyXG4gICAgICAgICAgICBmaWxlUGljayA9IHRoaXMucGlja0ZpbGUuYmluZCh0aGlzKTtcclxuICAgICAgICAgICAgdmFyIGNsZWFyQnV0dG9uID0gUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwgeyBjbGFzc05hbWU6IFwiZ2x5cGhpY29uIGdseXBoaWNvbi1yZW1vdmUgZmlsZS1ib3gtaGVhZGVyLWJ1dHRvblwiLCBvbkNsaWNrOiB0aGlzLmNsZWFyRmlsZS5iaW5kKHRoaXMpIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJmaWxlLWJveFwiLCBzdHlsZTogc3R5bGUgfSxcclxuICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJmaWxlLWJveC1oZWFkZXJcIiB9LFxyXG4gICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJmaWxlLWJveC1oZWFkZXItbGVmdFwiIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwgeyBjbGFzc05hbWU6IFwiZmlsZS1ib3gtaGVhZGVyLXRpdGxlXCIgfSwgY2FwdGlvbikpLFxyXG4gICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJmaWxlLWJveC1oZWFkZXItcmlnaHRcIiB9LCBjbGVhckJ1dHRvbikpLFxyXG4gICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcImZpbGUtYm94LWJvZHlcIiwgb25DbGljazogZmlsZVBpY2sgfSxcclxuICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJpbWdcIiwgeyByZWY6IFwiaW1nXCIsIGNsYXNzTmFtZTogXCJmaWxlLWltYWdlXCIsIHNyYzogZmxvd1N0YXRlLmNvbnRlbnRWYWx1ZSB9KSxcclxuICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiLCB7IHJlZjogXCJmaWxlXCIsIHR5cGU6IFwiZmlsZVwiLCBjbGFzc05hbWU6IFwiZmlsZS1maWxlXCIsIG9uQ2hhbmdlOiB0aGlzLmZpbGVTZWxlY3RlZC5iaW5kKHRoaXMpIH0pKSk7XHJcbiAgICB9O1xyXG4gICAgRmlsZVBpY2tlci5wcm90b3R5cGUuY2xlYXJGaWxlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBmaWxlO1xyXG4gICAgICAgIGZpbGUgPSB0aGlzLnJlZnMuZmlsZTtcclxuICAgIH07XHJcbiAgICBGaWxlUGlja2VyLnByb3RvdHlwZS5waWNrRmlsZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZmlsZTtcclxuICAgICAgICBmaWxlID0gdGhpcy5yZWZzLmZpbGU7XHJcbiAgICAgICAgZmlsZS5jbGljaygpO1xyXG4gICAgfTtcclxuICAgIEZpbGVQaWNrZXIucHJvdG90eXBlLmZpbGVTZWxlY3RlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZmlsZTtcclxuICAgICAgICBmaWxlID0gdGhpcy5yZWZzLmZpbGU7XHJcbiAgICAgICAgaWYgKGZpbGUuZmlsZXMgJiYgZmlsZS5maWxlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHZhciBmbG93TW9kZWwgPSBtYW55d2hvLm1vZGVsLmdldENvbXBvbmVudCh0aGlzLmNvbXBvbmVudElkLCB0aGlzLmZsb3dLZXkpO1xyXG4gICAgICAgICAgICB2YXIgZmxvd1N0YXRlID0gbWFueXdoby5zdGF0ZS5nZXRDb21wb25lbnQodGhpcy5jb21wb25lbnRJZCwgdGhpcy5mbG93S2V5KTtcclxuICAgICAgICAgICAgdmFyIGFhXzEgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcclxuICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVzaXplZCA9IGFhXzEuUmVzaXplQmFzZTY0SW1nKGUudGFyZ2V0LnJlc3VsdCwgNDAwKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZS5maWxlc1swXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEZpbGVQaWNrZXIucHJvdG90eXBlLlJlc2l6ZUJhc2U2NEltZyA9IGZ1bmN0aW9uIChiYXNlNjQsIHdpZHRoKSB7XHJcbiAgICAgICAgdmFyIGZsb3dTdGF0ZSA9IG1hbnl3aG8uc3RhdGUuZ2V0Q29tcG9uZW50KHRoaXMuY29tcG9uZW50SWQsIHRoaXMuZmxvd0tleSk7XHJcbiAgICAgICAgdmFyIGZsb3dNb2RlbCA9IG1hbnl3aG8ubW9kZWwuZ2V0Q29tcG9uZW50KHRoaXMuY29tcG9uZW50SWQsIHRoaXMuZmxvd0tleSk7XHJcbiAgICAgICAgdmFyIGltZyA9IG5ldyBJbWFnZSgpO1xyXG4gICAgICAgIHZhciBzdGF0ZSA9IHRoaXM7XHJcbiAgICAgICAgaW1nLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGFzcGVjdFJhdGlvID0gaW1nLmhlaWdodCAvIGltZy53aWR0aDtcclxuICAgICAgICAgICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XHJcbiAgICAgICAgICAgIHZhciByZWR1Y3Rpb25GYWN0b3IgPSB3aWR0aCAvIGltZy53aWR0aDtcclxuICAgICAgICAgICAgY2FudmFzLndpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSB3aWR0aCAqIGFzcGVjdFJhdGlvO1xyXG4gICAgICAgICAgICB2YXIgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICAgICAgICAgIHZhciByZWR1Y3Rpb25GYWN0b3IgPSB3aWR0aCAvIGltZy53aWR0aDtcclxuICAgICAgICAgICAgY29udGV4dC5zY2FsZShjYW52YXMud2lkdGggLyBpbWcud2lkdGgsIGNhbnZhcy5oZWlnaHQgLyBpbWcuaGVpZ2h0KTtcclxuICAgICAgICAgICAgY29udGV4dC5kcmF3SW1hZ2UoaW1nLCAwLCAwKTtcclxuICAgICAgICAgICAgdmFyIHJlc2l6ZWQgPSBjYW52YXMudG9EYXRhVVJMKCk7XHJcbiAgICAgICAgICAgIGZsb3dTdGF0ZS5jb250ZW50VmFsdWUgPSByZXNpemVkO1xyXG4gICAgICAgICAgICBpbWcuc3JjID0gcmVzaXplZDtcclxuICAgICAgICAgICAgc3RhdGUuZm9yY2VVcGRhdGUoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGltZy5zcmMgPSBiYXNlNjQ7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEZpbGVQaWNrZXI7XHJcbn0oUmVhY3QuQ29tcG9uZW50KSk7XHJcbm1hbnl3aG8uY29tcG9uZW50LnJlZ2lzdGVyKCdGaWxlUGlja2VyJywgRmlsZVBpY2tlcik7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IEZpbGVQaWNrZXI7XHJcblxuXG4vKioqLyB9KSxcbi8qIDIgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdDtcblxuLyoqKi8gfSksXG4vKiAzICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cbi8vIHJlbW92ZWQgYnkgZXh0cmFjdC10ZXh0LXdlYnBhY2stcGx1Z2luXG5cbi8qKiovIH0pXG4vKioqKioqLyBdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gRmlsZVBpY2tlci5qcyIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svYm9vdHN0cmFwIDAxYjIzNzI3OTYwYWFkZmNmNGY3IiwiZXhwb3J0ICogZnJvbSAnLi9GaWxlUGlja2VyJztcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9pbmRleC50c3giLCJcclxuZGVjbGFyZSB2YXIgbWFueXdobzogYW55O1xyXG5cclxuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgJy4vRmlsZVBpY2tlci5jc3MnO1xyXG5cclxuY2xhc3MgRmlsZVBpY2tlciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxhbnksIGFueT4gXHJcbnsgICBcclxuICAgIGNvbXBvbmVudElkOiBzdHJpbmcgPSBcIlwiO1xyXG4gICAgZmxvd0tleTogc3RyaW5nID1cIlwiOyAgICBcclxuICAgIGF0dHJpYnV0ZXMgOiBhbnkgPSB7fTtcclxuICAgIHNlbGVjdGVkSXRlbTogc3RyaW5nID0gbnVsbDtcclxuXHJcbiAgICB0ZXh0IDogc3RyaW5nID0gXCJcIjtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcyA6IGFueSlcclxuXHR7XHJcbiAgICAgICAgc3VwZXIocHJvcHMpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuY29tcG9uZW50SWQgPSBwcm9wcy5pZDtcclxuICAgICAgICB0aGlzLmZsb3dLZXkgPSBwcm9wcy5mbG93S2V5O1xyXG5cclxuICAgICAgICAvL3B1c2ggYXR0cmlidXRlcyBpbnRvIGtleWVkIG1hcCBcclxuXHRcdHZhciBmbG93TW9kZWwgPSBtYW55d2hvLm1vZGVsLmdldENvbXBvbmVudCh0aGlzLnByb3BzLmlkLCAgIHRoaXMucHJvcHMuZmxvd0tleSk7XHJcblx0XHRpZihmbG93TW9kZWwuYXR0cmlidXRlcylcclxuXHRcdHtcclxuXHRcdFx0Zm9yKHZhciBrZXkgaW4gZmxvd01vZGVsLmF0dHJpYnV0ZXMpXHJcblx0XHRcdHtcclxuXHRcdFx0XHR0aGlzLmF0dHJpYnV0ZXNba2V5XSA9IGZsb3dNb2RlbC5hdHRyaWJ1dGVzW2tleV07XHJcblx0XHRcdH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgXHJcbiAgICBjb21wb25lbnREaWRNb3VudCgpIFxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuZm9yY2VVcGRhdGUoKTtcclxuICAgIH1cclxuXHJcbiAgICBjb21wb25lbnREaWRVcGRhdGUoKVxyXG4gICAge1xyXG5cclxuICAgIH1cclxuXHJcblx0Z2V0QXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUgOiBzdHJpbmcpXHJcblx0e1xyXG5cdFx0aWYodGhpcy5hdHRyaWJ1dGVzW2F0dHJpYnV0ZU5hbWVdKVxyXG5cdFx0e1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5hdHRyaWJ1dGVzW2F0dHJpYnV0ZU5hbWVdO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZVxyXG5cdFx0e1xyXG5cdFx0XHRyZXR1cm4gbnVsbDtcclxuXHRcdH1cclxuXHR9XHJcblxyXG4gICAgICAgXHJcbiAgICByZW5kZXIoKVxyXG4gICAge1xyXG4gICAgICAgIGNvbnN0IGZsb3dNb2RlbCA9IG1hbnl3aG8ubW9kZWwuZ2V0Q29tcG9uZW50KHRoaXMuY29tcG9uZW50SWQsICAgdGhpcy5mbG93S2V5KTtcclxuICAgICAgICBjb25zdCBmbG93U3RhdGUgPSBtYW55d2hvLnN0YXRlLmdldENvbXBvbmVudCh0aGlzLmNvbXBvbmVudElkLCAgIHRoaXMuZmxvd0tleSk7XHJcblxyXG4gICAgICAgIHZhciBmaWxlUGljayA6IGFueTtcclxuICAgICAgICB2YXIgY2FwdGlvbiA6IHN0cmluZyA9IHRoaXMuZ2V0QXR0cmlidXRlKFwiVGl0bGVcIikgfHwgXCJTZWxlY3QgRmlsZVwiO1xyXG4gICAgICAgIHZhciB3aWR0aCA9IGZsb3dNb2RlbC53aWR0aCArIFwicHhcIjtcclxuICAgICAgICB2YXIgaGVpZ2h0PWZsb3dNb2RlbC5oZWlnaHQgKyBcInB4XCI7XHJcblxyXG4gICAgICAgIHZhciBzdHlsZSA6IGFueSA9IHt9O1xyXG4gICAgICAgIHN0eWxlLndpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0O1xyXG5cclxuICAgICAgICBpZihmbG93TW9kZWwuaXNFZGl0YWJsZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGZpbGVQaWNrID0gdGhpcy5waWNrRmlsZS5iaW5kKHRoaXMpO1xyXG4gICAgICAgICAgICB2YXIgY2xlYXJCdXR0b24gPSA8c3BhbiBjbGFzc05hbWU9XCJnbHlwaGljb24gZ2x5cGhpY29uLXJlbW92ZSBmaWxlLWJveC1oZWFkZXItYnV0dG9uXCIgb25DbGljaz17dGhpcy5jbGVhckZpbGUuYmluZCh0aGlzKX0+PC9zcGFuPjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cImZpbGUtYm94XCIgc3R5bGU9e3N0eWxlfSA+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmaWxlLWJveC1oZWFkZXJcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmaWxlLWJveC1oZWFkZXItbGVmdFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiZmlsZS1ib3gtaGVhZGVyLXRpdGxlXCI+e2NhcHRpb259PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmaWxlLWJveC1oZWFkZXItcmlnaHRcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtjbGVhckJ1dHRvbn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmlsZS1ib3gtYm9keVwiIG9uQ2xpY2s9e2ZpbGVQaWNrfT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGltZyByZWY9XCJpbWdcIiBjbGFzc05hbWU9XCJmaWxlLWltYWdlXCIgc3JjPXtmbG93U3RhdGUuY29udGVudFZhbHVlfT48L2ltZz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHJlZj1cImZpbGVcIiB0eXBlPVwiZmlsZVwiIGNsYXNzTmFtZT1cImZpbGUtZmlsZVwiIG9uQ2hhbmdlPXt0aGlzLmZpbGVTZWxlY3RlZC5iaW5kKHRoaXMpfT48L2lucHV0PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgIH1cclxuXHJcbiAgICBjbGVhckZpbGUoKVxyXG4gICAge1xyXG4gICAgICAgIHZhciBmaWxlIDogYW55O1xyXG4gICAgICAgIGZpbGUgPSB0aGlzLnJlZnMuZmlsZTtcclxuXHJcbiAgICB9XHJcbiAgICBwaWNrRmlsZSgpXHJcbiAgICB7XHJcbiAgICAgICAgdmFyIGZpbGUgOiBhbnk7XHJcbiAgICAgICAgZmlsZSA9IHRoaXMucmVmcy5maWxlO1xyXG4gICAgICAgIGZpbGUuY2xpY2soKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZmlsZVNlbGVjdGVkKClcclxuICAgIHtcclxuICAgICAgICB2YXIgZmlsZSA6IGFueTtcclxuICAgICAgICBmaWxlID0gdGhpcy5yZWZzLmZpbGU7XHJcblxyXG4gICAgICAgIGlmKGZpbGUuZmlsZXMgJiYgZmlsZS5maWxlcy5sZW5ndGggPiAwKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgY29uc3QgZmxvd01vZGVsID0gbWFueXdoby5tb2RlbC5nZXRDb21wb25lbnQodGhpcy5jb21wb25lbnRJZCwgICB0aGlzLmZsb3dLZXkpO1xyXG4gICAgICAgICAgICBjb25zdCBmbG93U3RhdGUgPSBtYW55d2hvLnN0YXRlLmdldENvbXBvbmVudCh0aGlzLmNvbXBvbmVudElkLCAgIHRoaXMuZmxvd0tleSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGFhID0gdGhpcztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcclxuICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlIDogYW55KSBcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlc2l6ZWQgPSBhYS5SZXNpemVCYXNlNjRJbWcoZS50YXJnZXQucmVzdWx0LDQwMCk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlLmZpbGVzWzBdKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIFJlc2l6ZUJhc2U2NEltZyhiYXNlNjQgOiBzdHJpbmcsIHdpZHRoIDogbnVtYmVyKSBcclxuICAgIHtcclxuICAgICAgICBjb25zdCBmbG93U3RhdGUgPSBtYW55d2hvLnN0YXRlLmdldENvbXBvbmVudCh0aGlzLmNvbXBvbmVudElkLCAgIHRoaXMuZmxvd0tleSk7XHJcbiAgICAgICAgY29uc3QgZmxvd01vZGVsID0gbWFueXdoby5tb2RlbC5nZXRDb21wb25lbnQodGhpcy5jb21wb25lbnRJZCwgICB0aGlzLmZsb3dLZXkpO1xyXG4gICAgICAgIHZhciBpbWcgPSBuZXcgSW1hZ2UoKTtcclxuICAgICAgICB2YXIgc3RhdGUgOiBhbnkgPXRoaXM7XHJcbiAgICAgICAgaW1nLm9ubG9hZCA9IGZ1bmN0aW9uKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgYXNwZWN0UmF0aW8gPSBpbWcuaGVpZ2h0IC9pbWcud2lkdGg7XHJcbiAgICAgICAgICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIHJlZHVjdGlvbkZhY3RvciA9IHdpZHRoIC8gaW1nLndpZHRoO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY2FudmFzLndpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSB3aWR0aCAqIGFzcGVjdFJhdGlvO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG5cclxuICAgICAgICAgICAgdmFyIHJlZHVjdGlvbkZhY3RvciA9IHdpZHRoIC8gaW1nLndpZHRoO1xyXG4gICAgICAgICAgICBjb250ZXh0LnNjYWxlKGNhbnZhcy53aWR0aC9pbWcud2lkdGggLCBjYW52YXMuaGVpZ2h0IC8gaW1nLmhlaWdodCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKGltZywgMCAsIDApO1xyXG4gICAgICAgICAgICB2YXIgcmVzaXplZCA9IGNhbnZhcy50b0RhdGFVUkwoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGZsb3dTdGF0ZS5jb250ZW50VmFsdWUgPSByZXNpemVkO1xyXG4gICAgICAgICAgICBpbWcuc3JjID0gcmVzaXplZDtcclxuICAgICAgICAgICAgc3RhdGUuZm9yY2VVcGRhdGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaW1nLnNyYyA9IGJhc2U2NDtcclxuICAgIH1cclxufVxyXG5cclxubWFueXdoby5jb21wb25lbnQucmVnaXN0ZXIoJ0ZpbGVQaWNrZXInLCBGaWxlUGlja2VyKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IEZpbGVQaWNrZXI7XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL0ZpbGVQaWNrZXIudHN4IiwibW9kdWxlLmV4cG9ydHMgPSBSZWFjdDtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcIlJlYWN0XCJcbi8vIG1vZHVsZSBpZCA9IDJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==