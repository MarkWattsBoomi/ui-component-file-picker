!function(e){function t(n){if(o[n])return o[n].exports;var i=o[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var o={};t.m=e,t.c=o,t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}(o(1))},function(e,t,o){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=o(2);o(3);var r=function(e){function t(t){var o=e.call(this,t)||this;o.componentId="",o.flowKey="",o.attributes={},o.selectedItem=null,o.text="",o.componentId=t.id,o.flowKey=t.flowKey;var n=manywho.model.getComponent(o.props.id,o.props.flowKey);if(n.attributes)for(var i in n.attributes)o.attributes[i]=n.attributes[i];return o}return n(t,e),t.prototype.componentDidMount=function(){this.forceUpdate()},t.prototype.componentDidUpdate=function(){},t.prototype.getAttribute=function(e){return this.attributes[e]?this.attributes[e]:null},t.prototype.render=function(){var e,t=manywho.model.getComponent(this.componentId,this.flowKey),o=manywho.state.getComponent(this.componentId,this.flowKey),n=this.getAttribute("Title"),r=t.width+"px",a=t.height+"px",l={};if(l.width=r,l.height=a,t.isEditable){e=this.pickFile.bind(this),n+=" - click the area below to choose a file";var s=i.createElement("span",{className:"glyphicon glyphicon-remove file-box-header-button",onClick:this.clearFile.bind(this)})}return i.createElement("div",{className:"file-box",style:l},i.createElement("div",{className:"file-box-header"},i.createElement("div",{style:{float:"left"}},i.createElement("span",{className:"file-box-header-title"},n)),i.createElement("div",{style:{float:"right"}},s)),i.createElement("div",{className:"file-box-body",onClick:e},i.createElement("img",{ref:"img",className:"file-image",src:o.contentValue}),i.createElement("input",{ref:"file",type:"file",className:"file-file",onChange:this.fileSelected.bind(this)})))},t.prototype.clearFile=function(){this.refs.file},t.prototype.pickFile=function(){var e;e=this.refs.file,e.click()},t.prototype.fileSelected=function(){var e;if(e=this.refs.file,e.files&&e.files.length>0){var t=(manywho.model.getComponent(this.componentId,this.flowKey),manywho.state.getComponent(this.componentId,this.flowKey),this),o=new FileReader;o.onload=function(e){t.ResizeBase64Img(e.target.result,400)},o.readAsDataURL(e.files[0])}},t.prototype.ResizeBase64Img=function(e,t){var o=manywho.state.getComponent(this.componentId,this.flowKey),n=(manywho.model.getComponent(this.componentId,this.flowKey),new Image),i=this;n.onload=function(){var e=n.height/n.width,r=document.createElement("canvas");n.width;r.width=t,r.height=t*e;var a=r.getContext("2d");n.width;a.scale(r.width/n.width,r.height/n.height),a.drawImage(n,0,0);var l=r.toDataURL();o.contentValue=l,n.src=l,i.forceUpdate()},n.src=e},t}(i.Component);manywho.component.register("FilePicker",r),t.default=r},function(e,t){e.exports=React},function(e,t){}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vRmlsZVBpY2tlci5qcyIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgODUzNmRmODQ5ZTI4MDg4Zjg2NzMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LnRzeCIsIndlYnBhY2s6Ly8vLi9zcmMvRmlsZVBpY2tlci50c3giLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiUmVhY3RcIiJdLCJuYW1lcyI6WyJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsImdldCIsIm4iLCJfX2VzTW9kdWxlIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwidmFsdWUiLCJfX2V4dGVuZHMiLCJ0aGlzIiwiZXh0ZW5kU3RhdGljcyIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiQXJyYXkiLCJiIiwiX18iLCJjb25zdHJ1Y3RvciIsImNyZWF0ZSIsIlJlYWN0IiwiRmlsZVBpY2tlciIsIl9zdXBlciIsInByb3BzIiwiX3RoaXMiLCJjb21wb25lbnRJZCIsImZsb3dLZXkiLCJhdHRyaWJ1dGVzIiwic2VsZWN0ZWRJdGVtIiwidGV4dCIsImlkIiwiZmxvd01vZGVsIiwibWFueXdobyIsIm1vZGVsIiwiZ2V0Q29tcG9uZW50Iiwia2V5IiwiY29tcG9uZW50RGlkTW91bnQiLCJmb3JjZVVwZGF0ZSIsImNvbXBvbmVudERpZFVwZGF0ZSIsImdldEF0dHJpYnV0ZSIsImF0dHJpYnV0ZU5hbWUiLCJyZW5kZXIiLCJmaWxlUGljayIsImZsb3dTdGF0ZSIsInN0YXRlIiwiY2FwdGlvbiIsIndpZHRoIiwiaGVpZ2h0Iiwic3R5bGUiLCJpc0VkaXRhYmxlIiwicGlja0ZpbGUiLCJiaW5kIiwiY2xlYXJCdXR0b24iLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwib25DbGljayIsImNsZWFyRmlsZSIsImZsb2F0IiwicmVmIiwic3JjIiwiY29udGVudFZhbHVlIiwidHlwZSIsIm9uQ2hhbmdlIiwiZmlsZVNlbGVjdGVkIiwicmVmcyIsImZpbGUiLCJjbGljayIsImZpbGVzIiwibGVuZ3RoIiwiYWFfMSIsInJlYWRlciIsIkZpbGVSZWFkZXIiLCJvbmxvYWQiLCJlIiwiUmVzaXplQmFzZTY0SW1nIiwidGFyZ2V0IiwicmVzdWx0IiwicmVhZEFzRGF0YVVSTCIsImJhc2U2NCIsImltZyIsIkltYWdlIiwiYXNwZWN0UmF0aW8iLCJjYW52YXMiLCJkb2N1bWVudCIsImNvbnRleHQiLCJnZXRDb250ZXh0Iiwic2NhbGUiLCJkcmF3SW1hZ2UiLCJyZXNpemVkIiwidG9EYXRhVVJMIiwiQ29tcG9uZW50IiwiY29tcG9uZW50IiwicmVnaXN0ZXIiLCJkZWZhdWx0Il0sIm1hcHBpbmdzIjoiQ0FBUyxTQUFVQSxHQ0luQixRQUFBQyxHQUFBQyxHQUdBLEdBQUFDLEVBQUFELEdBQ0EsTUFBQUMsR0FBQUQsR0FBQUUsT0FHQSxJQUFBQyxHQUFBRixFQUFBRCxJQUNBSSxFQUFBSixFQUNBSyxHQUFBLEVBQ0FILFdBVUEsT0FOQUosR0FBQUUsR0FBQU0sS0FBQUgsRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUgsR0FHQUksRUFBQUUsR0FBQSxFQUdBRixFQUFBRCxRQXZCQSxHQUFBRCxLQTRCQUYsR0FBQVEsRUFBQVQsRUFHQUMsRUFBQVMsRUFBQVAsRUFHQUYsRUFBQVUsRUFBQSxTQUFBUCxFQUFBUSxFQUFBQyxHQUNBWixFQUFBYSxFQUFBVixFQUFBUSxJQUNBRyxPQUFBQyxlQUFBWixFQUFBUSxHQUNBSyxjQUFBLEVBQ0FDLFlBQUEsRUFDQUMsSUFBQU4sS0FNQVosRUFBQW1CLEVBQUEsU0FBQWYsR0FDQSxHQUFBUSxHQUFBUixLQUFBZ0IsV0FD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S0FBS2MsWUFBZWQsS0FBS2UsU0FFbEVxRCxHQURjL0MsUUFBUUMsTUFBTUMsYUFBYXZCLEtBQUtjLFlBQWVkLEtBQUtlLFNBQzVELEdBQUlzRCxRQUNWcEMsRUFBYWpDLElBQ2pCb0UsR0FBSVAsT0FBUyxXQUdULEdBQUlTLEdBQWNGLEVBQUloQyxPQUFRZ0MsRUFBSWpDLE1BQzlCb0MsRUFBU0MsU0FBUzlCLGNBQWMsU0FFTjBCLEdBQUlqQyxLQUVsQ29DLEdBQU9wQyxNQUFRQSxFQUNmb0MsRUFBT25DLE9BQVNELEVBQVFtQyxDQUV4QixJQUFJRyxHQUFVRixFQUFPRyxXQUFXLEtBRUZOLEdBQUlqQyxLQUNsQ3NDLEdBQVFFLE1BQU1KLEVBQU9wQyxNQUFNaUMsRUFBSWpDLE1BQVFvQyxFQUFPbkMsT0FBU2dDLEVBQUloQyxRQUUzRHFDLEVBQVFHLFVBQVVSLEVBQUssRUFBSSxFQUMzQixJQUFJUyxHQUFVTixFQUFPTyxXQUVyQjlDLEdBQVVpQixhQUFlNEIsRUFDekJULEVBQUlwQixJQUFNNkIsRUFDVjVDLEVBQU1QLGVBRVYwQyxFQUFJcEIsSUFBTW1CLEdBRWxCekQsR0E1SnlCRCxFQUFNc0UsVUE4Si9CMUQsU0FBUTJELFVBQVVDLFNBQVMsYUFBY3ZFLEdBRXpDcEMsRUFBQTRHLFFBQWV4RSxHSHlDVCxTQUFVbkMsRUFBUUQsR0kvTXhCQyxFQUFBRCxRQUFBbUMsT0pxTk0sU0FBVWxDLEVBQVFEIiwiZmlsZSI6IkZpbGVQaWNrZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi8gXHRcdH1cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGk6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bDogZmFsc2UsXG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuLyoqKioqKi8gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbi8qKioqKiovIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4vKioqKioqLyBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4vKioqKioqLyBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4vKioqKioqLyBcdFx0XHRcdGdldDogZ2V0dGVyXG4vKioqKioqLyBcdFx0XHR9KTtcbi8qKioqKiovIFx0XHR9XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbi8qKioqKiovIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuLyoqKioqKi8gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbi8qKioqKiovIFx0XHRyZXR1cm4gZ2V0dGVyO1xuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIChbXG4vKiAwICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXHJcbmZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcclxufVxyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbl9fZXhwb3J0KF9fd2VicGFja19yZXF1aXJlX18oMSkpO1xyXG5cblxuLyoqKi8gfSksXG4vKiAxICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXHJcbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XHJcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbiAgICB9O1xyXG59KSgpO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbnZhciBSZWFjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XHJcbl9fd2VicGFja19yZXF1aXJlX18oMyk7XHJcbnZhciBGaWxlUGlja2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgX19leHRlbmRzKEZpbGVQaWNrZXIsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBGaWxlUGlja2VyKHByb3BzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuY29tcG9uZW50SWQgPSBcIlwiO1xyXG4gICAgICAgIF90aGlzLmZsb3dLZXkgPSBcIlwiO1xyXG4gICAgICAgIF90aGlzLmF0dHJpYnV0ZXMgPSB7fTtcclxuICAgICAgICBfdGhpcy5zZWxlY3RlZEl0ZW0gPSBudWxsO1xyXG4gICAgICAgIF90aGlzLnRleHQgPSBcIlwiO1xyXG4gICAgICAgIF90aGlzLmNvbXBvbmVudElkID0gcHJvcHMuaWQ7XHJcbiAgICAgICAgX3RoaXMuZmxvd0tleSA9IHByb3BzLmZsb3dLZXk7XHJcbiAgICAgICAgLy9wdXNoIGF0dHJpYnV0ZXMgaW50byBrZXllZCBtYXAgXHJcbiAgICAgICAgdmFyIGZsb3dNb2RlbCA9IG1hbnl3aG8ubW9kZWwuZ2V0Q29tcG9uZW50KF90aGlzLnByb3BzLmlkLCBfdGhpcy5wcm9wcy5mbG93S2V5KTtcclxuICAgICAgICBpZiAoZmxvd01vZGVsLmF0dHJpYnV0ZXMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGZsb3dNb2RlbC5hdHRyaWJ1dGVzKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5hdHRyaWJ1dGVzW2tleV0gPSBmbG93TW9kZWwuYXR0cmlidXRlc1trZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIEZpbGVQaWNrZXIucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuZm9yY2VVcGRhdGUoKTtcclxuICAgIH07XHJcbiAgICBGaWxlUGlja2VyLnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB9O1xyXG4gICAgRmlsZVBpY2tlci5wcm90b3R5cGUuZ2V0QXR0cmlidXRlID0gZnVuY3Rpb24gKGF0dHJpYnV0ZU5hbWUpIHtcclxuICAgICAgICBpZiAodGhpcy5hdHRyaWJ1dGVzW2F0dHJpYnV0ZU5hbWVdKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmF0dHJpYnV0ZXNbYXR0cmlidXRlTmFtZV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRmlsZVBpY2tlci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBmbG93TW9kZWwgPSBtYW55d2hvLm1vZGVsLmdldENvbXBvbmVudCh0aGlzLmNvbXBvbmVudElkLCB0aGlzLmZsb3dLZXkpO1xyXG4gICAgICAgIHZhciBmbG93U3RhdGUgPSBtYW55d2hvLnN0YXRlLmdldENvbXBvbmVudCh0aGlzLmNvbXBvbmVudElkLCB0aGlzLmZsb3dLZXkpO1xyXG4gICAgICAgIHZhciBmaWxlUGljaztcclxuICAgICAgICB2YXIgY2FwdGlvbiA9IHRoaXMuZ2V0QXR0cmlidXRlKFwiVGl0bGVcIik7XHJcbiAgICAgICAgdmFyIHdpZHRoID0gZmxvd01vZGVsLndpZHRoICsgXCJweFwiO1xyXG4gICAgICAgIHZhciBoZWlnaHQgPSBmbG93TW9kZWwuaGVpZ2h0ICsgXCJweFwiO1xyXG4gICAgICAgIHZhciBzdHlsZSA9IHt9O1xyXG4gICAgICAgIHN0eWxlLndpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0O1xyXG4gICAgICAgIGlmIChmbG93TW9kZWwuaXNFZGl0YWJsZSkge1xyXG4gICAgICAgICAgICBmaWxlUGljayA9IHRoaXMucGlja0ZpbGUuYmluZCh0aGlzKTtcclxuICAgICAgICAgICAgY2FwdGlvbiA9IGNhcHRpb24gKyBcIiAtIGNsaWNrIHRoZSBhcmVhIGJlbG93IHRvIGNob29zZSBhIGZpbGVcIjtcclxuICAgICAgICAgICAgdmFyIGNsZWFyQnV0dG9uID0gUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwgeyBjbGFzc05hbWU6IFwiZ2x5cGhpY29uIGdseXBoaWNvbi1yZW1vdmUgZmlsZS1ib3gtaGVhZGVyLWJ1dHRvblwiLCBvbkNsaWNrOiB0aGlzLmNsZWFyRmlsZS5iaW5kKHRoaXMpIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJmaWxlLWJveFwiLCBzdHlsZTogc3R5bGUgfSxcclxuICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJmaWxlLWJveC1oZWFkZXJcIiB9LFxyXG4gICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IHN0eWxlOiB7IGZsb2F0OiAnbGVmdCcgfSB9LFxyXG4gICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIHsgY2xhc3NOYW1lOiBcImZpbGUtYm94LWhlYWRlci10aXRsZVwiIH0sIGNhcHRpb24pKSxcclxuICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBzdHlsZTogeyBmbG9hdDogJ3JpZ2h0JyB9IH0sIGNsZWFyQnV0dG9uKSksXHJcbiAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwiZmlsZS1ib3gtYm9keVwiLCBvbkNsaWNrOiBmaWxlUGljayB9LFxyXG4gICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcImltZ1wiLCB7IHJlZjogXCJpbWdcIiwgY2xhc3NOYW1lOiBcImZpbGUtaW1hZ2VcIiwgc3JjOiBmbG93U3RhdGUuY29udGVudFZhbHVlIH0pLFxyXG4gICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcImlucHV0XCIsIHsgcmVmOiBcImZpbGVcIiwgdHlwZTogXCJmaWxlXCIsIGNsYXNzTmFtZTogXCJmaWxlLWZpbGVcIiwgb25DaGFuZ2U6IHRoaXMuZmlsZVNlbGVjdGVkLmJpbmQodGhpcykgfSkpKTtcclxuICAgIH07XHJcbiAgICBGaWxlUGlja2VyLnByb3RvdHlwZS5jbGVhckZpbGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGZpbGU7XHJcbiAgICAgICAgZmlsZSA9IHRoaXMucmVmcy5maWxlO1xyXG4gICAgfTtcclxuICAgIEZpbGVQaWNrZXIucHJvdG90eXBlLnBpY2tGaWxlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBmaWxlO1xyXG4gICAgICAgIGZpbGUgPSB0aGlzLnJlZnMuZmlsZTtcclxuICAgICAgICBmaWxlLmNsaWNrKCk7XHJcbiAgICB9O1xyXG4gICAgRmlsZVBpY2tlci5wcm90b3R5cGUuZmlsZVNlbGVjdGVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBmaWxlO1xyXG4gICAgICAgIGZpbGUgPSB0aGlzLnJlZnMuZmlsZTtcclxuICAgICAgICBpZiAoZmlsZS5maWxlcyAmJiBmaWxlLmZpbGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdmFyIGZsb3dNb2RlbCA9IG1hbnl3aG8ubW9kZWwuZ2V0Q29tcG9uZW50KHRoaXMuY29tcG9uZW50SWQsIHRoaXMuZmxvd0tleSk7XHJcbiAgICAgICAgICAgIHZhciBmbG93U3RhdGUgPSBtYW55d2hvLnN0YXRlLmdldENvbXBvbmVudCh0aGlzLmNvbXBvbmVudElkLCB0aGlzLmZsb3dLZXkpO1xyXG4gICAgICAgICAgICB2YXIgYWFfMSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xyXG4gICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXNpemVkID0gYWFfMS5SZXNpemVCYXNlNjRJbWcoZS50YXJnZXQucmVzdWx0LCA0MDApO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlLmZpbGVzWzBdKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRmlsZVBpY2tlci5wcm90b3R5cGUuUmVzaXplQmFzZTY0SW1nID0gZnVuY3Rpb24gKGJhc2U2NCwgd2lkdGgpIHtcclxuICAgICAgICB2YXIgZmxvd1N0YXRlID0gbWFueXdoby5zdGF0ZS5nZXRDb21wb25lbnQodGhpcy5jb21wb25lbnRJZCwgdGhpcy5mbG93S2V5KTtcclxuICAgICAgICB2YXIgZmxvd01vZGVsID0gbWFueXdoby5tb2RlbC5nZXRDb21wb25lbnQodGhpcy5jb21wb25lbnRJZCwgdGhpcy5mbG93S2V5KTtcclxuICAgICAgICB2YXIgaW1nID0gbmV3IEltYWdlKCk7XHJcbiAgICAgICAgdmFyIHN0YXRlID0gdGhpcztcclxuICAgICAgICBpbWcub25sb2FkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYXNwZWN0UmF0aW8gPSBpbWcuaGVpZ2h0IC8gaW1nLndpZHRoO1xyXG4gICAgICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcclxuICAgICAgICAgICAgdmFyIHJlZHVjdGlvbkZhY3RvciA9IHdpZHRoIC8gaW1nLndpZHRoO1xyXG4gICAgICAgICAgICBjYW52YXMud2lkdGggPSB3aWR0aDtcclxuICAgICAgICAgICAgY2FudmFzLmhlaWdodCA9IHdpZHRoICogYXNwZWN0UmF0aW87XHJcbiAgICAgICAgICAgIHZhciBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuICAgICAgICAgICAgdmFyIHJlZHVjdGlvbkZhY3RvciA9IHdpZHRoIC8gaW1nLndpZHRoO1xyXG4gICAgICAgICAgICBjb250ZXh0LnNjYWxlKGNhbnZhcy53aWR0aCAvIGltZy53aWR0aCwgY2FudmFzLmhlaWdodCAvIGltZy5oZWlnaHQpO1xyXG4gICAgICAgICAgICBjb250ZXh0LmRyYXdJbWFnZShpbWcsIDAsIDApO1xyXG4gICAgICAgICAgICB2YXIgcmVzaXplZCA9IGNhbnZhcy50b0RhdGFVUkwoKTtcclxuICAgICAgICAgICAgZmxvd1N0YXRlLmNvbnRlbnRWYWx1ZSA9IHJlc2l6ZWQ7XHJcbiAgICAgICAgICAgIGltZy5zcmMgPSByZXNpemVkO1xyXG4gICAgICAgICAgICBzdGF0ZS5mb3JjZVVwZGF0ZSgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgaW1nLnNyYyA9IGJhc2U2NDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRmlsZVBpY2tlcjtcclxufShSZWFjdC5Db21wb25lbnQpKTtcclxubWFueXdoby5jb21wb25lbnQucmVnaXN0ZXIoJ0ZpbGVQaWNrZXInLCBGaWxlUGlja2VyKTtcclxuZXhwb3J0cy5kZWZhdWx0ID0gRmlsZVBpY2tlcjtcclxuXG5cbi8qKiovIH0pLFxuLyogMiAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0O1xuXG4vKioqLyB9KSxcbi8qIDMgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuLy8gcmVtb3ZlZCBieSBleHRyYWN0LXRleHQtd2VicGFjay1wbHVnaW5cblxuLyoqKi8gfSlcbi8qKioqKiovIF0pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBGaWxlUGlja2VyLmpzIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbiBcdFx0XHRcdGdldDogZ2V0dGVyXG4gXHRcdFx0fSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgODUzNmRmODQ5ZTI4MDg4Zjg2NzMiLCJleHBvcnQgKiBmcm9tICcuL0ZpbGVQaWNrZXInO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2luZGV4LnRzeCIsIlxyXG5kZWNsYXJlIHZhciBtYW55d2hvOiBhbnk7XHJcblxyXG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCAnLi9GaWxlUGlja2VyLmNzcyc7XHJcblxyXG5jbGFzcyBGaWxlUGlja2VyIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PGFueSwgYW55PiBcclxueyAgIFxyXG4gICAgY29tcG9uZW50SWQ6IHN0cmluZyA9IFwiXCI7XHJcbiAgICBmbG93S2V5OiBzdHJpbmcgPVwiXCI7ICAgIFxyXG4gICAgYXR0cmlidXRlcyA6IGFueSA9IHt9O1xyXG4gICAgc2VsZWN0ZWRJdGVtOiBzdHJpbmcgPSBudWxsO1xyXG5cclxuICAgIHRleHQgOiBzdHJpbmcgPSBcIlwiO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByb3BzIDogYW55KVxyXG5cdHtcclxuICAgICAgICBzdXBlcihwcm9wcyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5jb21wb25lbnRJZCA9IHByb3BzLmlkO1xyXG4gICAgICAgIHRoaXMuZmxvd0tleSA9IHByb3BzLmZsb3dLZXk7XHJcblxyXG4gICAgICAgIC8vcHVzaCBhdHRyaWJ1dGVzIGludG8ga2V5ZWQgbWFwIFxyXG5cdFx0dmFyIGZsb3dNb2RlbCA9IG1hbnl3aG8ubW9kZWwuZ2V0Q29tcG9uZW50KHRoaXMucHJvcHMuaWQsICAgdGhpcy5wcm9wcy5mbG93S2V5KTtcclxuXHRcdGlmKGZsb3dNb2RlbC5hdHRyaWJ1dGVzKVxyXG5cdFx0e1xyXG5cdFx0XHRmb3IodmFyIGtleSBpbiBmbG93TW9kZWwuYXR0cmlidXRlcylcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHRoaXMuYXR0cmlidXRlc1trZXldID0gZmxvd01vZGVsLmF0dHJpYnV0ZXNba2V5XTtcclxuXHRcdFx0fVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBcclxuICAgIGNvbXBvbmVudERpZE1vdW50KCkgXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5mb3JjZVVwZGF0ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbXBvbmVudERpZFVwZGF0ZSgpXHJcbiAgICB7XHJcblxyXG4gICAgfVxyXG5cclxuXHRnZXRBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSA6IHN0cmluZylcclxuXHR7XHJcblx0XHRpZih0aGlzLmF0dHJpYnV0ZXNbYXR0cmlidXRlTmFtZV0pXHJcblx0XHR7XHJcblx0XHRcdHJldHVybiB0aGlzLmF0dHJpYnV0ZXNbYXR0cmlidXRlTmFtZV07XHJcblx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHR7XHJcblx0XHRcdHJldHVybiBudWxsO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcbiAgICAgICBcclxuICAgIHJlbmRlcigpXHJcbiAgICB7XHJcbiAgICAgICAgY29uc3QgZmxvd01vZGVsID0gbWFueXdoby5tb2RlbC5nZXRDb21wb25lbnQodGhpcy5jb21wb25lbnRJZCwgICB0aGlzLmZsb3dLZXkpO1xyXG4gICAgICAgIGNvbnN0IGZsb3dTdGF0ZSA9IG1hbnl3aG8uc3RhdGUuZ2V0Q29tcG9uZW50KHRoaXMuY29tcG9uZW50SWQsICAgdGhpcy5mbG93S2V5KTtcclxuXHJcbiAgICAgICAgdmFyIGZpbGVQaWNrIDogYW55O1xyXG4gICAgICAgIHZhciBjYXB0aW9uIDogc3RyaW5nID0gdGhpcy5nZXRBdHRyaWJ1dGUoXCJUaXRsZVwiKTtcclxuICAgICAgICB2YXIgd2lkdGggPSBmbG93TW9kZWwud2lkdGggKyBcInB4XCI7XHJcbiAgICAgICAgdmFyIGhlaWdodD1mbG93TW9kZWwuaGVpZ2h0ICsgXCJweFwiO1xyXG5cclxuICAgICAgICB2YXIgc3R5bGUgOiBhbnkgPSB7fTtcclxuICAgICAgICBzdHlsZS53aWR0aCA9IHdpZHRoO1xyXG4gICAgICAgIHN0eWxlLmhlaWdodCA9IGhlaWdodDtcclxuXHJcbiAgICAgICAgaWYoZmxvd01vZGVsLmlzRWRpdGFibGUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBmaWxlUGljayA9IHRoaXMucGlja0ZpbGUuYmluZCh0aGlzKTtcclxuICAgICAgICAgICAgY2FwdGlvbiA9IGNhcHRpb24gKyBcIiAtIGNsaWNrIHRoZSBhcmVhIGJlbG93IHRvIGNob29zZSBhIGZpbGVcIjtcclxuICAgICAgICAgICAgdmFyIGNsZWFyQnV0dG9uID0gPHNwYW4gY2xhc3NOYW1lPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1yZW1vdmUgZmlsZS1ib3gtaGVhZGVyLWJ1dHRvblwiIG9uQ2xpY2s9e3RoaXMuY2xlYXJGaWxlLmJpbmQodGhpcyl9Pjwvc3Bhbj47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJmaWxlLWJveFwiIHN0eWxlPXtzdHlsZX0gPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmlsZS1ib3gtaGVhZGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9e3tmbG9hdDonbGVmdCd9fT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImZpbGUtYm94LWhlYWRlci10aXRsZVwiPntjYXB0aW9ufTwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9e3tmbG9hdDoncmlnaHQnfX0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y2xlYXJCdXR0b259XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZpbGUtYm94LWJvZHlcIiBvbkNsaWNrPXtmaWxlUGlja30+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgcmVmPVwiaW1nXCIgY2xhc3NOYW1lPVwiZmlsZS1pbWFnZVwiIHNyYz17Zmxvd1N0YXRlLmNvbnRlbnRWYWx1ZX0+PC9pbWc+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCByZWY9XCJmaWxlXCIgdHlwZT1cImZpbGVcIiBjbGFzc05hbWU9XCJmaWxlLWZpbGVcIiBvbkNoYW5nZT17dGhpcy5maWxlU2VsZWN0ZWQuYmluZCh0aGlzKX0+PC9pbnB1dD5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICB9XHJcblxyXG4gICAgY2xlYXJGaWxlKClcclxuICAgIHtcclxuICAgICAgICB2YXIgZmlsZSA6IGFueTtcclxuICAgICAgICBmaWxlID0gdGhpcy5yZWZzLmZpbGU7XHJcblxyXG4gICAgfVxyXG4gICAgcGlja0ZpbGUoKVxyXG4gICAge1xyXG4gICAgICAgIHZhciBmaWxlIDogYW55O1xyXG4gICAgICAgIGZpbGUgPSB0aGlzLnJlZnMuZmlsZTtcclxuICAgICAgICBmaWxlLmNsaWNrKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGZpbGVTZWxlY3RlZCgpXHJcbiAgICB7XHJcbiAgICAgICAgdmFyIGZpbGUgOiBhbnk7XHJcbiAgICAgICAgZmlsZSA9IHRoaXMucmVmcy5maWxlO1xyXG5cclxuICAgICAgICBpZihmaWxlLmZpbGVzICYmIGZpbGUuZmlsZXMubGVuZ3RoID4gMClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZsb3dNb2RlbCA9IG1hbnl3aG8ubW9kZWwuZ2V0Q29tcG9uZW50KHRoaXMuY29tcG9uZW50SWQsICAgdGhpcy5mbG93S2V5KTtcclxuICAgICAgICAgICAgY29uc3QgZmxvd1N0YXRlID0gbWFueXdoby5zdGF0ZS5nZXRDb21wb25lbnQodGhpcy5jb21wb25lbnRJZCwgICB0aGlzLmZsb3dLZXkpO1xyXG4gICAgICAgICAgICBjb25zdCBhYSA9IHRoaXM7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcbiAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSA6IGFueSkgXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXNpemVkID0gYWEuUmVzaXplQmFzZTY0SW1nKGUudGFyZ2V0LnJlc3VsdCw0MDApO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZS5maWxlc1swXSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBSZXNpemVCYXNlNjRJbWcoYmFzZTY0IDogc3RyaW5nLCB3aWR0aCA6IG51bWJlcikgXHJcbiAgICB7XHJcbiAgICAgICAgY29uc3QgZmxvd1N0YXRlID0gbWFueXdoby5zdGF0ZS5nZXRDb21wb25lbnQodGhpcy5jb21wb25lbnRJZCwgICB0aGlzLmZsb3dLZXkpO1xyXG4gICAgICAgIGNvbnN0IGZsb3dNb2RlbCA9IG1hbnl3aG8ubW9kZWwuZ2V0Q29tcG9uZW50KHRoaXMuY29tcG9uZW50SWQsICAgdGhpcy5mbG93S2V5KTtcclxuICAgICAgICB2YXIgaW1nID0gbmV3IEltYWdlKCk7XHJcbiAgICAgICAgdmFyIHN0YXRlIDogYW55ID10aGlzO1xyXG4gICAgICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbigpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIGFzcGVjdFJhdGlvID0gaW1nLmhlaWdodCAvaW1nLndpZHRoO1xyXG4gICAgICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciByZWR1Y3Rpb25GYWN0b3IgPSB3aWR0aCAvIGltZy53aWR0aDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNhbnZhcy53aWR0aCA9IHdpZHRoO1xyXG4gICAgICAgICAgICBjYW52YXMuaGVpZ2h0ID0gd2lkdGggKiBhc3BlY3RSYXRpbztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuXHJcbiAgICAgICAgICAgIHZhciByZWR1Y3Rpb25GYWN0b3IgPSB3aWR0aCAvIGltZy53aWR0aDtcclxuICAgICAgICAgICAgY29udGV4dC5zY2FsZShjYW52YXMud2lkdGgvaW1nLndpZHRoICwgY2FudmFzLmhlaWdodCAvIGltZy5oZWlnaHQpO1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgICBjb250ZXh0LmRyYXdJbWFnZShpbWcsIDAgLCAwKTtcclxuICAgICAgICAgICAgdmFyIHJlc2l6ZWQgPSBjYW52YXMudG9EYXRhVVJMKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBmbG93U3RhdGUuY29udGVudFZhbHVlID0gcmVzaXplZDtcclxuICAgICAgICAgICAgaW1nLnNyYyA9IHJlc2l6ZWQ7XHJcbiAgICAgICAgICAgIHN0YXRlLmZvcmNlVXBkYXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGltZy5zcmMgPSBiYXNlNjQ7XHJcbiAgICB9XHJcbn1cclxuXHJcbm1hbnl3aG8uY29tcG9uZW50LnJlZ2lzdGVyKCdGaWxlUGlja2VyJywgRmlsZVBpY2tlcik7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBGaWxlUGlja2VyO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9GaWxlUGlja2VyLnRzeCIsIm1vZHVsZS5leHBvcnRzID0gUmVhY3Q7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJSZWFjdFwiXG4vLyBtb2R1bGUgaWQgPSAyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=